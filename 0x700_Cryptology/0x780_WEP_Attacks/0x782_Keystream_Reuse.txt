Another potential problem with WEP lies in keystream reuse
If 2 plaintexts (P) are XORed with the same keystream to produce 2 separate ciphertexts (C), XORing those ciphertexts together will cancel out the keystream, resulting in the 2 plaintexts XORed with each other
(C 1) = (P1C 2 = P2 ⊕ RC4(seed)
(C 1) ⊕ (C 2) = [(P 1) ⊕ RC4(seed)] ⊕ [(P 2) ⊕ RC4(seed)] = (P 1) ⊕ (P 2)) ⊕ RC4(seed)

From here, if one of the plaintexts is known, the other can easily be recovered
In addition, since the plaintexts in this case are Internet packets with a known and fairly predictable structure, various techniques can be employed to recover both original plaintexts

The IV is intended to prevent these types of attacks; without it, every packet would be encrypted with the same keystream
If a different IV is used for each packet, the keystreams for packets will also be different
However, if the same IV is reused, both packets will be encrypted with the same keystream
This is a condition that is easy to detect, since the IVs are included in plaintext in the encrypted packets
Moreover, the IVs used for WEP are only 24 bits in length, which nearly guarantees that IVs will be reused
Assuming that IVs are chosen at random, statistically there should be a case of keystream reuse after just 5000 packets

This number seems surprisingly small due to a counterintuitive probabilistic phenomenon known as the birthday paradox
This paradox states that if 23 people are in the same room, 2 of these people should share a birthday
With 23 people, there are (23 · 22) / 2, or 253, possible pairs
Each pair has a probability of success of 1 / 365 or about 0.27 percent, which corresponds to a probability of failure of 1 − (1 / 365), or about 99.726 percent
By raising this probability to the power of 253, the overall probability of failure is shown to be about 49.95 percent, meaning that the probability of success is just a little over 50 percent

This works the same way with IV collisions
With 5000 packets, there are (5000 · 4999) / 2, or 12,497,500, possible pairs
Each pair has a probability of failure of 1 - (1 / 2^24)
When this is raised to the power of the number of possible pairs, the overall probability of failure is about 47.5 percent, meaning that there's a 52.5 percent chance of an IV collision with just 5000 packets

After an IV collision is discovered, some educated guesses about the structure of the plaintexts can be used to reveal the original plaintexts by XORing the 2 ciphertexts together
Also, if one of the plaintexts is known, the other plaintext can be recovered with a simple XORing
One method of obtaining known plaintexts might be through spam email, where the attacker sends the spam and the victim checks mail over the encrypted wireless connection